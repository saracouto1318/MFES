\begin{vdmpp}[breaklines=true]
class Surgery is subclass of Task
instance variables
  private secondaryDoctors:set of (HealthProfessional);
  private other:set of (HealthProfessional);
  
  inv card (*@\vdmnotcovered{secondaryDoctors}@*) >= (*@\vdmnotcovered{0}@*);
  inv card other >= (*@\vdmnotcovered{0}@*);
operations
(*@
\label{Surgery:9}
@*)
 public Surgery: HealthProfessional * Schedule * Patient * Hospital ==> Surgery
  Surgery(s, sch, p, h) == (medicalAssoc := s ; other := (*@\vdmnotcovered{\{}@*)}; secondaryDoctors := {}; Task(s, sch, p, (*@\vdmnotcovered{h}@*), (*@\vdmnotcovered{<Surgery>}@*)))
 post medicalAssoc (*@\vdmnotcovered{=}@*) (*@\vdmnotcovered{s}@*) (*@\vdmnotcovered{and}@*) (*@\vdmnotcovered{other}@*) = {} and secondaryDoctors (*@\vdmnotcovered{=}@*) (*@\vdmnotcovered{\{}@*)};
 
(*@
\label{addSecondaryDoctor:13}
@*)
 public addSecondaryDoctor : HealthProfessional ==> ()
  addSecondaryDoctor(s) == (secondaryDoctors := (*@\vdmnotcovered{secondaryDoctors}@*) union (*@\vdmnotcovered{\{}@*)(*@\vdmnotcovered{s}@*)})
 pre s <> medicalAssoc and s.getType() = <Surgeon> and  s not in set (*@\vdmnotcovered{secondaryDoctors}@*)
 post (*@\vdmnotcovered{s}@*) (*@\vdmnotcovered{in}@*) set (*@\vdmnotcovered{secondaryDoctors}@*);
  
(*@
\label{removeSecondaryDoctor:18}
@*)
 public removeSecondaryDoctor : HealthProfessional ==> ()
  removeSecondaryDoctor(s) == (secondaryDoctors := secondaryDoctors (*@\vdmnotcovered{\textbackslash }@*) (*@\vdmnotcovered{\{}@*)(*@\vdmnotcovered{s}@*)})
 pre s.getType() (*@\vdmnotcovered{=}@*) <Surgeon> and s in set (*@\vdmnotcovered{secondaryDoctors}@*)
 post s (*@\vdmnotcovered{not}@*) in set (*@\vdmnotcovered{secondaryDoctors}@*);
  
(*@
\label{addOther:23}
@*)
 public addOther : HealthProfessional ==> ()
  addOther(s) == (*@\vdmnotcovered{(}@*)(*@\vdmnotcovered{other}@*) := other union (*@\vdmnotcovered{\{}@*)(*@\vdmnotcovered{s}@*)})
 pre s.getType() = <Nurse> (*@\vdmnotcovered{and}@*) s not in set (*@\vdmnotcovered{other}@*)
 post s in set (*@\vdmnotcovered{other}@*);
  
(*@
\label{removeOther:28}
@*)
 public removeOther : HealthProfessional ==> ()
  removeOther(s) == (*@\vdmnotcovered{(}@*)(*@\vdmnotcovered{other}@*) := other \ {(*@\vdmnotcovered{s}@*)})
 pre s.getType() (*@\vdmnotcovered{=}@*) <Nurse> and s in set (*@\vdmnotcovered{other}@*)
 post s not in set (*@\vdmnotcovered{other}@*);
  
(*@
\label{setMainDoctor:33}
@*)
 public setMainDoctor : HealthProfessional ==> ()
  setMainDoctor(s) == (medicalAssoc := (*@\vdmnotcovered{s}@*))
 pre (*@\vdmnotcovered{s}@*).(*@\vdmnotcovered{getType}@*)() = (*@\vdmnotcovered{<Surgeon>}@*) and s not in set (*@\vdmnotcovered{secondaryDoctors}@*);
 
(*@
\label{getMainDoctor:37}
@*)
 public getMainDoctor : () ==> HealthProfessional
  getMainDoctor() == (*@\vdmnotcovered{(}@*)(*@\vdmnotcovered{return}@*) (*@\vdmnotcovered{medicalAssoc}@*));

(*@
\label{getSurgeryPersons:40}
@*)
 pure public getSurgeryPersons : Types`Type ==> set of (HealthProfessional)
  getSurgeryPersons(t) == (*@\vdmnotcovered{(}@*)
               dcl med : set of (HealthProfessional);
               if((*@\vdmnotcovered{t}@*) (*@\vdmnotcovered{=}@*) (*@\vdmnotcovered{<Surgeon>}@*))
                then med := (*@\vdmnotcovered{secondaryDoctors}@*)
               else
                (*@\vdmnotcovered{med}@*) := (*@\vdmnotcovered{other}@*);
               (*@\vdmnotcovered{return}@*) (*@\vdmnotcovered{med}@*));
end Surgery
\end{vdmpp}
\bigskip
\begin{longtable}{|l|r|r|r|}
\hline
Function or operation & Line & Coverage & Calls \\
\hline
\hline
\hyperref[Surgery:9]{Surgery} & 9&0.0\% & 0 \\
\hline
\hyperref[addOther:23]{addOther} & 23&0.0\% & 0 \\
\hline
\hyperref[addSecondaryDoctor:13]{addSecondaryDoctor} & 13&0.0\% & 0 \\
\hline
\hyperref[getMainDoctor:37]{getMainDoctor} & 37&0.0\% & 0 \\
\hline
\hyperref[getSurgeryPersons:40]{getSurgeryPersons} & 40&0.0\% & 0 \\
\hline
\hyperref[removeOther:28]{removeOther} & 28&0.0\% & 0 \\
\hline
\hyperref[removeSecondaryDoctor:18]{removeSecondaryDoctor} & 18&0.0\% & 0 \\
\hline
\hyperref[setMainDoctor:33]{setMainDoctor} & 33&0.0\% & 0 \\
\hline
\hline
Surgery.vdmpp & & 0.0\% & 0 \\
\hline
\end{longtable}

