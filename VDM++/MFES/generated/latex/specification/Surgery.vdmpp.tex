\begin{vdmpp}[breaklines=true]
class Surgery is subclass of Task

types

instance variables
  public secondaryDoctors:set of (MedicalAssociated);
  public other:set of (MedicalAssociated);
  
  inv card secondaryDoctors >= 0;
  inv card other >= 0;
operations

 public Surgery: MedicalAssociated ==> Surgery
  Surgery(s) == (medicalAssoc := s ; other := {}; secondaryDoctors := {}; return self)
(*@
\label{Surgery:15}
@*)
 post medicalAssoc = s and other = {} and secondaryDoctors = {};
 
 pure public addSecondaryDoctor : MedicalAssociated ==> set of (MedicalAssociated)
  addSecondaryDoctor(s) == (return secondaryDoctors union {s})
(*@
\label{addSecondaryDoctor:19}
@*)
 pre s <> medicalAssoc and s.getType() = <Surgeon> and  s not in set secondaryDoctors
 post s in set secondaryDoctors;
  
 pure public removeSecondaryDoctor : MedicalAssociated ==> set of (MedicalAssociated)
  removeSecondaryDoctor(s) == (return secondaryDoctors \ {s})
(*@
\label{removeSecondaryDoctor:24}
@*)
 pre s.getType() = <Surgeon> and s in set secondaryDoctors
 post s not in set secondaryDoctors;
  
 pure public addOther : MedicalAssociated ==> set of (MedicalAssociated)
  addOther(s) == (return other union {s})
(*@
\label{addOther:29}
@*)
 pre s.getType() = <Nurse> and s not in set other
 post s in set other;
  
 pure public removeOther : MedicalAssociated ==> set of (MedicalAssociated)
  removeOther(s) == (return other \ {s})
(*@
\label{removeOther:34}
@*)
 pre s.getType() = <Nurse> and s in set other
 post s not in set other;
  
 public setMainDoctor : MedicalAssociated ==> ()
  setMainDoctor(s) == (medicalAssoc := s)
(*@
\label{setMainDoctor:39}
@*)
 pre s.getType() = <Surgeon> and s not in set secondaryDoctors;
 
(*@
\label{getSurgeryPersons:41}
@*)
 public getMainDoctor : () ==> MedicalAssociated
(*@
\label{getMainDoctor:42}
@*)
  getMainDoctor() == (return medicalAssoc);
  
 public getSurgeryPersons : () ==> seq of (set of (MedicalAssociated))
(*@
\label{getSecondaryDoctors:45}
@*)
  getSurgeryPersons() == (
               dcl med : seq of (set of (MedicalAssociated));
               med := med ^ [secondaryDoctors] ^ [other];
(*@
\label{getOthers:48}
@*)
               return med);
  
 pure public getType : () ==> seq of (char) 
(*@
\label{getType:51}
@*)
  getType() == (return "Surgery");

end Surgery
\end{vdmpp}
