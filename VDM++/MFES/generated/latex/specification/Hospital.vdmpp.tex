\begin{vdmpp}[breaklines=true]
class Hospital
instance variables
  private medicalAssociated: set of (HealthProfessional);
  private agenda : set of (Agenda);
  private name: Types`String;
  private address: Types`String;
  private tasks: set of(Task);
  private trainings: set of(Training);
  private safetyNet: SafetyNetHospital;
 
 inv card medicalAssociated >= 0;
 inv card agenda >= 0;
 inv card tasks >= 0;
operations

(*@
\label{Hospital:16}
@*)
 public Hospital: Types`String * Types`String * SafetyNetHospital ==> Hospital
  Hospital(n, a, s) == (name := n; address := a; safetyNet := s; medicalAssociated := {}; tasks := {}; trainings := {}; agenda := {};
  safetyNet.addHospital(self); return self)
 post name = n and address = a and safetyNet = s and medicalAssociated = {} and tasks = {} and trainings = {} and agenda = {};
 
(*@
\label{getName:21}
@*)
 pure public getName: () ==> Types`String
  getName() == (return name);
 
(*@
\label{getAddress:24}
@*)
 pure public getAddress: () ==> Types`String
  getAddress() == (return address);
 
(*@
\label{getAgendas:27}
@*)
 pure public getAgendas : () ==> set of(Agenda)
  getAgendas() == (return agenda);
  
(*@
\label{getAgenda:30}
@*)
 pure public getAgenda : HealthProfessional ==> set of(Schedule)
  getAgenda(h) == (
   dcl agendaNew : set of(Schedule);
   agendaNew := {};
   for all a in set agenda do
    if(a.getHealthProfessional() = h)
     then agendaNew := a.getAgenda();
(*@
\label{removeAgenda:37}
@*)
   return agendaNew);
 
 public removeAgenda : Agenda ==> ()
  removeAgenda(a) == (agenda := agenda \ {a})
 pre a in set agenda
(*@
\label{addMedAssociated:42}
@*)
 post a not in set agenda;
 
 public addMedAssociated: HealthProfessional ==> ()
  addMedAssociated(d) == (
   dcl agendaNew : Agenda;
   agendaNew := new Agenda(d);
   agenda := agenda union {agendaNew};
   medicalAssociated := {d} union medicalAssociated)
 pre d not in set medicalAssociated
(*@
\label{removeMedAssociated:51}
@*)
 post d in set medicalAssociated;
  
 public removeMedAssociated: HealthProfessional ==> ()
  removeMedAssociated(d) == (
   for all t in set tasks do
    if(d = t.getMedAssoc())
     then removeTask(t);
   for all t in set trainings do
    if(d = t.getMedAssoc())
     then removeTraining(t);
   for all a in set agenda do
    if(a.getHealthProfessional().getCC() = d.getCC())
     then removeAgenda(a);
   medicalAssociated := medicalAssociated \ {d})
 pre d in set medicalAssociated
(*@
\label{addTask:66}
@*)
 post d not in set medicalAssociated;
 
 public addTask: Task ==> ()
  addTask(d) == (
   if(d.getPatient() not in set d.getMedAssoc().getPatients())
    then d.getMedAssoc().addPatient(d.getPatient());
   tasks := {d} union tasks;
   for all a in set agenda do
    if(a.getHealthProfessional().getCC() = d.getMedAssoc().getCC())
      then a.removeSchedule(d.getSchedule());)
 pre d not in set tasks and d.getSchedule() in set getAgenda(d.getMedAssoc())
(*@
\label{removeTask:77}
@*)
 post d in set tasks and d.getPatient() in set d.getMedAssoc().getPatients() and d.getSchedule() not in set getAgenda(d.getMedAssoc());
  
 public removeTask: Task ==> ()
  removeTask(d) == (
   for all a in set agenda do
    if(a.getHealthProfessional() = d.getMedAssoc())
      then a.addSchedule(d.getSchedule());
   tasks := tasks \ {d})
 pre d in set tasks and d.getSchedule() not in set getAgenda(d.getMedAssoc())
(*@
\label{addTraining:86}
@*)
 post d not in set tasks and d.getSchedule() in set getAgenda(d.getMedAssoc());
 
 public addTraining: Training ==> ()
  addTraining(d) == (
   for all a in set agenda do
    if(a.getHealthProfessional() = d.getMedAssoc())
      then a.removeSchedule(d.getSchedule());
   trainings := {d} union trainings)
 pre d not in set trainings and d.getSchedule() in set getAgenda(d.getMedAssoc())
(*@
\label{removeTraining:95}
@*)
 post d in set trainings and d.getSchedule() not in set getAgenda(d.getMedAssoc());
  
 public removeTraining: Training ==> ()
  removeTraining(d) == (
   for all a in set agenda do
    if(a.getHealthProfessional() = d.getMedAssoc())
      then a.addSchedule(d.getSchedule());
   trainings := trainings \ {d})
 pre d in set trainings and d.getSchedule() not in set getAgenda(d.getMedAssoc())
(*@
\label{getTasksByType:104}
@*)
 post d not in set trainings and d.getSchedule() in set getAgenda(d.getMedAssoc());
 
 pure public getTasksByType: Types`TaskType ==> set of (Task)
  getTasksByType(s) == (
   dcl tasksTotal: set of (Task);
   tasksTotal := {};
   for all t in set tasks do
    if(t.getType() = s)
     then tasksTotal := tasksTotal union {t};
     
(*@
\label{getTrainingsByType:114}
@*)
   return tasksTotal);
              
 pure public getTrainingsByType: Types`Purpose ==> set of (Training)
  getTrainingsByType(s) == (
   dcl train: set of (Training);
   train := {};
   for all t in set trainings do
    if(t.getPurpose() = s)
     then train := train union {t};
     
(*@
\label{getMedicalAssociatedByType:124}
@*)
   return train);

 pure public getMedicalAssociatedByType: Types`Type ==> set of (HealthProfessional)
  getMedicalAssociatedByType(type) == (
   dcl med: set of(HealthProfessional);
   med := {};
   for all d in set medicalAssociated do
    if(d.getType() = type)
     then med := med union {d};
    
   return med);
end Hospital
\end{vdmpp}
\bigskip
\begin{longtable}{|l|r|r|r|}
\hline
Function or operation & Line & Coverage & Calls \\
\hline
\hline
\hyperref[Hospital:16]{Hospital} & 16&100.0\% & 28 \\
\hline
\hyperref[addMedAssociated:42]{addMedAssociated} & 42&100.0\% & 11 \\
\hline
\hyperref[addTask:66]{addTask} & 66&100.0\% & 12 \\
\hline
\hyperref[addTraining:86]{addTraining} & 86&100.0\% & 2 \\
\hline
\hyperref[getAddress:24]{getAddress} & 24&100.0\% & 12 \\
\hline
\hyperref[getAgenda:30]{getAgenda} & 30&100.0\% & 38 \\
\hline
\hyperref[getAgendas:27]{getAgendas} & 27&100.0\% & 12 \\
\hline
\hyperref[getMedicalAssociatedByType:124]{getMedicalAssociatedByType} & 124&100.0\% & 33 \\
\hline
\hyperref[getName:21]{getName} & 21&100.0\% & 40 \\
\hline
\hyperref[getTasksByType:104]{getTasksByType} & 104&100.0\% & 24 \\
\hline
\hyperref[getTrainingsByType:114]{getTrainingsByType} & 114&100.0\% & 3 \\
\hline
\hyperref[removeAgenda:37]{removeAgenda} & 37&100.0\% & 1 \\
\hline
\hyperref[removeMedAssociated:51]{removeMedAssociated} & 51&100.0\% & 5 \\
\hline
\hyperref[removeTask:77]{removeTask} & 77&100.0\% & 2 \\
\hline
\hyperref[removeTraining:95]{removeTraining} & 95&100.0\% & 2 \\
\hline
\hline
Hospital.vdmpp & & 100.0\% & 225 \\
\hline
\end{longtable}

